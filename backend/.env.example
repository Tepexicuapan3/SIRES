# ============================================
# PLANTILLA DE CONFIGURACIÓN - BACKEND
# Copia este archivo a .env y ajusta los valores
# ============================================

# --- FLASK ---
# Entry point de la aplicación (run.py es el estándar definido en Docker)
FLASK_APP=run.py
FLASK_ENV=development
FLASK_DEBUG=1
PORT=5000

# --- BASE DE DATOS (MySQL) ---
DB_HOST=10.15.15.76
DB_PORT=3306
DB_NAME=SIRES
DB_USER=sires
# ¡CAMBIAR ESTO! No subir contraseñas reales a Git
DB_PASSWORD=change_me

# --- CONEXIÓN SQLALCHEMY ---
# Construcción automática del string de conexión usando las variables de arriba
DATABASE_URL=mysql+pymysql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# --- SEGURIDAD ---
# Cambiar estas claves en producción por strings aleatorios largos
SECRET_KEY=change_me_dev_secret_key
JWT_SECRET_KEY=change_me_jwt_secret
JWT_ACCESS_TOKEN_EXPIRES=3600

# --- HttpOnly Cookies (Autenticación segura) ---
# Los tokens JWT se almacenan en cookies HttpOnly (no accesibles desde JS)
JWT_COOKIE_SECURE=false
# En producción con HTTPS, cambiar a: JWT_COOKIE_SECURE=true
JWT_COOKIE_SAMESITE=Lax
# Opciones: Strict (más seguro), Lax (recomendado), None (requiere HTTPS)

# --- RED & CORS ---
# IMPORTANTE: Debe incluir todos los orígenes del frontend
CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5173


#-------- Envio de codigos OTP ----------
SMTP_HOST = smtp.gmail.com
SMTP_PORT = 587
SMTP_USER = sires.stc@metro.cdmx.gob.mx
SMTP_PASSWORD = change_me
SMTP_FROM_EMAIL = sires.stc@metro.cdmx.gob.mx


# --- PROXY CORPORATIVO (STC METRO) ---
# Descomentar y ajustar si estás dentro de la red institucional
# HTTP_PROXY=http://10.15.15.56:3128
# HTTPS_PROXY=http://10.15.15.56:3128


# --- REDIS (OTP + Rate Limiting) ---
# Conexión a Redis para almacenar OTP y contadores de rate limiting
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0

# --- RATE LIMITING ---
# Límite de requests por minuto al endpoint de login
RATE_LIMIT_LOGIN_PER_MINUTE=10

# Límite más restrictivo para endpoints OTP/recovery (request-reset-code / verify-reset-code)
RATE_LIMIT_OTP_PER_MINUTE=5

# --- PROXIES / IP REAL DEL CLIENTE ---
# NO confíes en X-Forwarded-For salvo que estés detrás de un proxy controlado.
# Lista de IPs de proxies confiables (separadas por coma). Si está vacío, se ignoran esos headers.
# Ej: TRUSTED_PROXIES=127.0.0.1,172.18.0.1
TRUSTED_PROXIES=
